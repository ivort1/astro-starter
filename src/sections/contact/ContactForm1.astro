---
import { SERVICE_OPTIONS, SITE } from "../../data/site.en";
import Icon from "../../components/ui/Icon.astro";
---

<div>
  <h2 class="font-display text-[28px] font-semibold text-black mb-2">Request a Free Quote</h2>
  <p class="text-gray-700 leading-relaxed mb-8">
    Fill out the form below and we'll get back to you within 24 hours — usually much sooner.
  </p>

  <!-- Success State (hidden by default) -->
  <div id="form-success" class="hidden p-16 rounded-2xl border border-gray-100 text-center">
    <div class="text-5xl mb-4">✓</div>
    <h3 class="font-display text-2xl font-semibold mb-2">Thank You!</h3>
    <p class="text-gray-700">Your email client should have opened with your message. We'll get back to you shortly!</p>
    <a href={SITE.phoneTel} class="btn-primary mt-6 justify-center">
      <Icon name="phone" /> Or Call Us Now
    </a>
  </div>

  <!-- Form -->
  <div id="quote-form" class="p-12 rounded-2xl border border-gray-100">
    <div class="mb-5">
      <label class="block text-[13px] font-semibold tracking-wide mb-2 text-black">Your Name</label>
      <input id="f-name" class="form-input" placeholder="John Smith" />
    </div>

    <div class="mb-5">
      <label class="block text-[13px] font-semibold tracking-wide mb-2 text-black">Phone Number</label>
      <input id="f-phone" class="form-input" placeholder="(909) 555-0123" />
    </div>

    <div class="mb-5">
      <label class="block text-[13px] font-semibold tracking-wide mb-2 text-black">Email Address</label>
      <input id="f-email" class="form-input" placeholder="john@example.com" />
    </div>

    <div class="mb-5">
      <label class="block text-[13px] font-semibold tracking-wide mb-2 text-black">What Service Do You Need?</label>
      <select id="f-service" class="form-input" style="appearance: auto;">
        <option value="">Select a service...</option>
        {SERVICE_OPTIONS.map((opt) => (
          <option>{opt}</option>
        ))}
      </select>
    </div>

    <div class="mb-5">
      <label class="block text-[13px] font-semibold tracking-wide mb-2 text-black">Tell Us About Your Project</label>
      <textarea
        id="f-message"
        class="form-input resize-y min-h-[120px]"
        placeholder="Describe your project, timeline, and any details that would help us give you an accurate estimate..."
      ></textarea>
    </div>

    <button id="form-submit" class="btn-primary w-full justify-center mt-2">
      Send Quote Request <Icon name="arrow" />
    </button>

    <p class="text-center text-xs text-gray-500 mt-3">
      Free estimates · No obligation · Typically responds within hours
    </p>
  </div>
</div>

<script define:vars={{ email: SITE.email }}>
  document.getElementById("form-submit")?.addEventListener("click", () => {
    const name = document.getElementById("f-name")?.value || "";
    const phone = document.getElementById("f-phone")?.value || "";
    const service = document.getElementById("f-service")?.value || "";
    const message = document.getElementById("f-message")?.value || "";

    const subject = encodeURIComponent(`Quote Request from ${name}`);
    const body = encodeURIComponent(
      `Name: ${name}\nPhone: ${phone}\nService: ${service}\n\n${message}`
    );
    window.open(`mailto:${email}?subject=${subject}&body=${body}`);

    document.getElementById("quote-form")?.classList.add("hidden");
    document.getElementById("form-success")?.classList.remove("hidden");
  });
</script>
